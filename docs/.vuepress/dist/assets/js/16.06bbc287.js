(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{570:function(t,r,s){"use strict";s.r(r);var e=s(12),a=Object(e.a)({},(function(){var t=this,r=t.$createElement,s=t._self._c||r;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"err"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#err"}},[t._v("#")]),t._v(" err")]),t._v(" "),s("p",[t._v("页面错误自动收集,原理是监听"),s("code",[t._v("error unhandledrejection")]),t._v("事件以及劫持"),s("code",[t._v("console.error")]),t._v(",采集三类错误")]),t._v(" "),s("ul",[s("li",[t._v("资源加载错误,代码异常(error)")]),t._v(" "),s("li",[t._v("promise调用链异常(reject)")]),t._v(" "),s("li",[t._v("console.error异常")])]),t._v(" "),s("p",[t._v("触发事件时给后台的对象")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("属性名称")]),t._v(" "),s("th",[t._v("值")]),t._v(" "),s("th",[t._v("说明")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("eventId")]),t._v(" "),s("td",[t._v("code / HTML元素上发生异常则为元素名")]),t._v(" "),s("td",[t._v("事件ID")])]),t._v(" "),s("tr",[s("td",[t._v("eventType")]),t._v(" "),s("td",[t._v("error")]),t._v(" "),s("td",[t._v("事件类型")])]),t._v(" "),s("tr",[s("td",[t._v("url")]),t._v(" "),s("td"),t._v(" "),s("td",[t._v("当前页面URL")])]),t._v(" "),s("tr",[s("td",[t._v("sendTime")]),t._v(" "),s("td"),t._v(" "),s("td",[t._v("发送时间")])]),t._v(" "),s("tr",[s("td",[t._v("triggerTime")]),t._v(" "),s("td"),t._v(" "),s("td",[t._v("事件发生时间")])]),t._v(" "),s("tr",[s("td",[t._v("type")]),t._v(" "),s("td",[t._v("error")]),t._v(" "),s("td",[t._v("大类type,参考"),s("code",[t._v("数据结构")])])]),t._v(" "),s("tr",[s("td",[t._v("errMessage")]),t._v(" "),s("td"),t._v(" "),s("td",[t._v("错误信息")])]),t._v(" "),s("tr",[s("td",[t._v("errStack")]),t._v(" "),s("td"),t._v(" "),s("td",[t._v("完整的错误信息")])]),t._v(" "),s("tr",[s("td",[t._v("line")]),t._v(" "),s("td"),t._v(" "),s("td",[t._v("错误信息发生在第几行")])]),t._v(" "),s("tr",[s("td",[t._v("col")]),t._v(" "),s("td"),t._v(" "),s("td",[t._v("错误信息发生在第几列")])]),t._v(" "),s("tr",[s("td",[t._v("params")]),t._v(" "),s("td"),t._v(" "),s("td",[t._v("主动方法触发错误收集可以带参数")])])])]),t._v(" "),s("blockquote",[s("p",[t._v("注意: vue中代码报错也会触发console.error,加上控制台本身也会输出,这就意味着会触发两次,这一点后续会优化")])]),t._v(" "),s("h2",{attrs:{id:"传给后台格式示例"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#传给后台格式示例"}},[t._v("#")]),t._v(" 传给后台格式示例")]),t._v(" "),s("h3",{attrs:{id:"error实例引起的报错提交数据"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#error实例引起的报错提交数据"}},[t._v("#")]),t._v(" Error实例引起的报错提交数据")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  eventInfo"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      col"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"12"')]),t._v("\n      errMessage"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"window.sss is not a function"')]),t._v("\n      errStack"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"TypeError: window.sss is not a function\\n ....... "')]),t._v("\n      eventId"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"code"')]),t._v("\n      eventType"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"error"')]),t._v("\n      line"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"250"')]),t._v("\n      sendTime"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1641971814966")]),t._v("\n      src"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http://localhost:8083/err.js"')]),t._v("\n      triggerTime"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1641971813965")]),t._v("\n      type"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"error"')]),t._v("\n      url"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http://localhost:8083/err.html"')]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h3",{attrs:{id:"不是error实例引起的报错提交数据-这里是vue的报错"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#不是error实例引起的报错提交数据-这里是vue的报错"}},[t._v("#")]),t._v(" 不是Error实例引起的报错提交数据(这里是vue的报错)")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  eventInfo"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      errMessage"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"[Vue warn]: Error in created hook: \\"TypeError: windo ...."')]),t._v("\n      eventId"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"code"')]),t._v("\n      eventType"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"error"')]),t._v("\n      sendTime"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1641972159263")]),t._v("\n      triggerTime"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1641972158260")]),t._v("\n      type"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"error"')]),t._v("\n      url"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http://localhost:8083/err.html"')]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])])}),[],!1,null,null,null);r.default=a.exports}}]);